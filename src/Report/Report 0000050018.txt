OBJECT Report 50018 Contrepassation des FNP
{
  OBJECT-PROPERTIES
  {
    Date=01/06/15;
    Time=18:00:00;
    Modified=Yes;
    Version List=JX-VSC1.0-XAD,JX-VSC1.1-XAD,JX-VSC2.0-AUD;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Reversal of invoices not received;
               FRA=Contrepassation des FNP];
    ProcessingOnly=Yes;
    OnPreReport=BEGIN
                  Grec_FeuilleComptaEXTFNP.SETRANGE("Journal Template Name",Grec_FeuilleComptaEXTFNP."Journal Template Name");
                  Grec_FeuilleComptaEXTFNP.SETRANGE("Journal Batch Name",Grec_FeuilleComptaEXTFNP."Journal Batch Name");
                  IF (Grec_FeuilleComptaEXTFNP.COUNT > 0) THEN
                    IF NOT CONFIRM(Text002) THEN
                      ERROR(Text003);
                  Grec_FeuilleComptaEXTFNP.DELETEALL;
                  Grec_FeuilleComptaEXTFNP.LOCKTABLE;
                  Gcode_NoEXTFNP := Grec_FeuilleComptaEXTFNP."Document No.";
                  Gcode_CodeJournal := Grec_FeuilleComptaEXTFNP."Source Code";

                  IF Grec_GenJnlBatch.GET(Grec_FeuilleComptaEXTFNP."Journal Template Name",Grec_FeuilleComptaEXTFNP."Journal Batch Name") THEN
                    IF Grec_GenJnlBatch."No. Series" <> 'EXTFNP' THEN
                      ERROR(Text001);
                END;

  }
  DATASET
  {
    { 7069;    ;DataItem;                    ;
               DataItemTable=Table17;
               DataItemTableView=SORTING(Entry No.);
               OnPreDataItem=BEGIN
                               Grec_LigneNoSouche.RESET;
                               Grec_LigneNoSouche.SETFILTER(Grec_LigneNoSouche."Series Code",'FNP');
                               Grec_LigneNoSouche.SETFILTER(Grec_LigneNoSouche.Open,'%1',TRUE);
                               IF Grec_LigneNoSouche.FIND('-') THEN
                                 Gcode_NoFNP := Grec_LigneNoSouche."Last No. Used";

                               SETFILTER("G/L Entry"."Document No.",'%1',Gcode_NoFNP);

                               Gint_Ligne := 0;
                             END;

               OnAfterGetRecord=BEGIN

                                      //Insertion ligne CREDIT
                                      Grec_FeuilleComptaEXTFNP.INIT;
                                      Gint_Ligne += 10000;
                                      Grec_FeuilleComptaEXTFNP."Line No." := Gint_Ligne;
                                      Grec_FeuilleComptaEXTFNP."Document No." := Gcode_NoEXTFNP;
                                      Grec_FeuilleComptaEXTFNP."External Document No." := PADSTR("External Document No.",20);
                                      Grec_FeuilleComptaEXTFNP.VALIDATE("Source Code",Gcode_CodeJournal);
                                      Grec_FeuilleComptaEXTFNP.VALIDATE("Account No.","G/L Account No.");
                                      Grec_FeuilleComptaEXTFNP.VALIDATE(Grec_FeuilleComptaEXTFNP."Posting Date",Gdate_Compta);
                                      Grec_FeuilleComptaEXTFNP.VALIDATE(Grec_FeuilleComptaEXTFNP."Document Date","Document Date");
                                      IF ("G/L Entry"."Debit Amount" <> 0) THEN
                                        Grec_FeuilleComptaEXTFNP.VALIDATE("Credit Amount","G/L Entry"."Debit Amount")
                                      ELSE
                                        Grec_FeuilleComptaEXTFNP.VALIDATE("Debit Amount","G/L Entry"."Credit Amount");
                                      Grec_FeuilleComptaEXTFNP.Description := Description;
                                      Grec_FeuilleComptaEXTFNP."Vendor No." := "G/L Entry"."Vendor No.";
                                      Grec_FeuilleComptaEXTFNP.VALIDATE(Grec_FeuilleComptaEXTFNP."Gen. Bus. Posting Group",'');
                                      Grec_FeuilleComptaEXTFNP.VALIDATE(Grec_FeuilleComptaEXTFNP."Gen. Prod. Posting Group",'');
                                      Grec_FeuilleComptaEXTFNP.VALIDATE(Grec_FeuilleComptaEXTFNP."VAT Bus. Posting Group",'');
                                      Grec_FeuilleComptaEXTFNP.VALIDATE(Grec_FeuilleComptaEXTFNP."VAT Prod. Posting Group",'');
                                  //  Ins‚r‚rAnalytique();   Modification NAv 2015
                                      Grec_FeuilleComptaEXTFNP."Dimension Set ID" := "Dimension Set ID";
                                  //  Ins‚r‚rAnalytique();   Modification NAv 2015
                                      Grec_FeuilleComptaEXTFNP."Dimension Set ID" := "Dimension Set ID";
                                      Grec_FeuilleComptaEXTFNP.INSERT;
                                    //Gcode_NoEXTFNP := INCSTR(Gcode_NoEXTFNP);
                                END;
                                 }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1000000000;;Container;
                  Name=Options;
                  ContainerType=ContentArea }

      { 1000000001;1;Field  ;
                  Name=Date de comptabilisation;
                  SourceExpr=Gdate_Compta }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      Gint_Ligne@1000000000 : Integer;
      Grec_FeuilleComptaEXTFNP@1000000001 : Record 81;
      Gdec_MontantTTC@1000000002 : Decimal;
      Gdec_MontantHT@1000000003 : Decimal;
      Gdate_Compta@1000000004 : Date;
      "Grec_ParamŠtresTVA"@1000000005 : Record 325;
      Gcode_NoFNP@1000000006 : Code[20];
      Gcode_NoEXTFNP@1000000007 : Code[20];
      Gcode_CodeJournal@1000000008 : Code[10];
      Text001@1000000009 : TextConst 'ENU=This sheet is not a reversal of invoices not received.;FRA=Cette feuille n''est pas destin‚e … la contrepassation des FNP.';
      Text002@1000000010 : TextConst 'ENU=This sheet is not empty.\\All data being entered will be replaced.\\Would you like to continue ?;FRA=Cette feuille n''est pas vide.\\Toutes les donn‚es actuellement saises seront remplac‚es.\\Souhaitez-vous tout de mˆme poursuivre ?';
      Text003@1000000011 : TextConst 'ENU=Operation canceled;FRA=Op‚ration annul‚e';
      Grec_Fournisseur@1000000012 : Record 23;
      Grec_Dimension@1000000016 : Record 348;
      Gcode_CompteTVA@1000000017 : Code[20];
      Grec_GenJnlBatch@1000000018 : Record 232;
      "Gint_Ann‚eComptable"@1000000019 : Integer;
      "Gint_Ann‚eR‚ception"@1000000020 : Integer;
      Grec_ParamCompa@1000000021 : Record 98;
      "Gdate_D‚butExerciceComptable"@1000000022 : Date;
      Grec_LigneNoSouche@1000000023 : Record 309;

    PROCEDURE SetEXTFNPJnlLine@1000000000(FeuilleComptaEXTFNP@1000000000 : Record 81);
    BEGIN
      Grec_FeuilleComptaEXTFNP := FeuilleComptaEXTFNP;
    END;

    BEGIN
    {
      CEATION JX-XAD 27/10/2008
      Contrepassation des FNP dans la feuille de comptabilit‚ g‚n‚rale.

      JX-XAD 05/06/2009
      Traduction en Anglais

      //Modif JX-AUD du 05/02/2013
      //Retraitement des ajout des lignes analytiques
    }
    END.
  }
  RDLDATA
  {
  }
}


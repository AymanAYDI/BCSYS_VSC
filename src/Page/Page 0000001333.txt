OBJECT Page 1333 Mini Ven. Hist. Buy-from Tiles
{
  OBJECT-PROPERTIES
  {
    Date=09/09/14;
    Time=12:00:00;
    Version List=NAVW18.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Buy-from Vendor History;
               FRA=Historique fournisseur];
    SourceTable=Table23;
    PageType=CardPart;
    OnOpenPage=BEGIN
                 CalcNoOfBuyRecords;
               END;

    OnFindRecord=BEGIN
                   NoOfInvoices := 0;
                   NoOfCreditMemos := 0;
                   NoOfPostedInvoices := 0;
                   NoOfPostedCreditMemos := 0;

                   EXIT(FIND(Which));
                 END;

    OnAfterGetRecord=BEGIN
                       CalcNoOfBuyRecords;
                     END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=CueGroup }

    { 8   ;2   ;Field     ;
                DrillDown=Yes;
                CaptionML=[ENU=Open Purchase Invoices;
                           FRA=Factures achat ouvertes];
                SourceExpr=NoOfInvoices;
                Editable=TRUE;
                OnDrillDown=VAR
                              PurchaseHeader@1000 : Record 38;
                            BEGIN
                              PurchaseHeader.SETRANGE("Buy-from Vendor No.","No.");
                              PAGE.RUN(PAGE::"Mini Purchase Invoice List",PurchaseHeader);
                            END;
                             }

    { 12  ;2   ;Field     ;
                DrillDown=Yes;
                CaptionML=[ENU=Open Purchase Credit Memos;
                           FRA=Avoirs achat ouverts];
                SourceExpr=NoOfCreditMemos;
                Editable=TRUE;
                DrillDownPageID=Purchase Credit Memos;
                OnDrillDown=VAR
                              PurchaseHeader@1000 : Record 38;
                            BEGIN
                              PurchaseHeader.SETRANGE("Buy-from Vendor No.","No.");
                              PAGE.RUN(PAGE::"Mini Purchase Credit Memos",PurchaseHeader);
                            END;
                             }

    { 18  ;2   ;Field     ;
                DrillDown=Yes;
                CaptionML=[ENU=Posted Purchase Invoices;
                           FRA=Factures achat enregistr‚es];
                SourceExpr=NoOfPostedInvoices;
                Editable=TRUE;
                DrillDownPageID=Posted Purchase Invoices;
                OnDrillDown=VAR
                              PurchInvHeader@1000 : Record 122;
                            BEGIN
                              PurchInvHeader.SETRANGE("Buy-from Vendor No.","No.");
                              PAGE.RUN(PAGE::"Mini Posted Purchase Invoices",PurchInvHeader);
                            END;
                             }

    { 20  ;2   ;Field     ;
                DrillDown=Yes;
                CaptionML=[ENU=Posted Purchase Credit Memos;
                           FRA=Avoirs achat enregistr‚s];
                SourceExpr=NoOfPostedCreditMemos;
                Editable=TRUE;
                DrillDownPageID=Posted Purchase Credit Memos;
                OnDrillDown=VAR
                              PurchCrMemoHdr@1000 : Record 124;
                            BEGIN
                              PurchCrMemoHdr.SETRANGE("Buy-from Vendor No.","No.");
                              PAGE.RUN(PAGE::"Mini Posted Purch. Cr. Memos",PurchCrMemoHdr);
                            END;
                             }

  }
  CODE
  {
    VAR
      NoOfInvoices@1004 : Integer;
      NoOfCreditMemos@1003 : Integer;
      NoOfPostedInvoices@1001 : Integer;
      NoOfPostedCreditMemos@1000 : Integer;

    PROCEDURE ShowDetails@1102601000();
    BEGIN
      PAGE.RUN(PAGE::"Vendor Card",Rec);
    END;

    LOCAL PROCEDURE CalcNoOfBuyRecords@3();
    VAR
      PurchHeader@1000 : Record 38;
      PurchInvHeader@1001 : Record 122;
      PurchCrMemoHdr@1002 : Record 124;
    BEGIN
      PurchHeader.RESET;
      PurchHeader.SETRANGE("Document Type",PurchHeader."Document Type"::Invoice);
      PurchHeader.SETRANGE("Buy-from Vendor No.","No.");
      NoOfInvoices := PurchHeader.COUNT;

      PurchHeader.RESET;
      PurchHeader.SETRANGE("Document Type",PurchHeader."Document Type"::"Credit Memo");
      PurchHeader.SETRANGE("Buy-from Vendor No.","No.");
      NoOfCreditMemos := PurchHeader.COUNT;

      PurchInvHeader.RESET;
      PurchInvHeader.SETRANGE("Buy-from Vendor No.","No.");
      NoOfPostedInvoices := PurchInvHeader.COUNT;

      PurchCrMemoHdr.RESET;
      PurchCrMemoHdr.SETRANGE("Buy-from Vendor No.","No.");
      NoOfPostedCreditMemos := PurchCrMemoHdr.COUNT;
    END;

    BEGIN
    END.
  }
}

